<span *ngIf="showDutiesTable">
    <h3>Astronaut Duties for {{ data.person.name }}</h3>
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

        <ng-container matColumnDef="rank">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Rank </th>
            <td mat-cell *matCellDef="let astronautDuty">{{ astronautDuty.rank }}</td>
        </ng-container>

        <ng-container matColumnDef="dutyTitle">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Duty </th>
            <td mat-cell *matCellDef="let astronautDuty">{{ astronautDuty.dutyTitle }}</td>
        </ng-container>

        <ng-container matColumnDef="dutyStartDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Start Date </th>
            <td mat-cell *matCellDef="let astronautDuty">{{ astronautDuty.dutyStartDate | date:'mediumDate'}}</td>
        </ng-container>

        <ng-container matColumnDef="dutyEndDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> End Date </th>
            <td mat-cell *matCellDef="let astronautDuty">{{ astronautDuty.dutyEndDate ? (astronautDuty.dutyEndDate |
                date:'mediumDate') : '---'}}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
</span>

<span *ngIf="showDutyForm">
    <h3>Add New Astronaut Duty for {{ data.person.name }}</h3>
    <form [formGroup]="dutyForm" (ngSubmit)="onAddDuty()">
        <mat-form-field appearance="fill" class="form-field">
            <mat-label>Rank</mat-label>
            <mat-select formControlName="rank" required>
                <mat-option *ngFor="let rank of ranks" [value]="rank">
                    {{ getEnumName(RankEnum, rank) }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-field">
            <mat-label>Duty Title</mat-label>
            <mat-select formControlName="dutyTitle" required>
                <mat-option *ngFor="let title of dutyTitles" [value]="title">
                    {{ getEnumName(DutyTitleEnum, title) }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-field">
            <mat-label>Start Date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="dutyStartDate" required />
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="dutyForm.get('dutyStartDate')?.hasError('dateTooEarly')">Start date must succeed existing
                career dates</mat-error>
        </mat-form-field>

        <button mat-raised-button color="primary" type="submit" [disabled]="dutyForm.invalid">
            Add Duty
        </button>
    </form>
</span>

<div class="dialog-actions">
    <button *ngIf="showDutyForm" mat-raised-button color="primary" (click)="onConfirm()">
        <mat-icon>save</mat-icon>
        Save
    </button>

    <button mat-stroked-button color="warn" (click)="onCancel()">
        <mat-icon *ngIf="showDutyForm">cancel</mat-icon>
        <mat-icon *ngIf="!showDutyForm">close</mat-icon>
        {{ showDutyForm ? 'Cancel' : 'Close' }}
    </button>
</div>